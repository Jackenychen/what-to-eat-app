(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{167:(e,r,t)=>{Promise.resolve().then(t.bind(t,6442))},6442:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(5155),a=t(2115);function l(e){let{inputValue:r,setInputValue:t,onAddDish:a,onKeyPress:l,loading:o=!1}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"添加菜品"}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("input",{type:"text",value:r,onChange:e=>t(e.target.value),onKeyPress:l,placeholder:"输入菜名...",disabled:o,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed"}),(0,s.jsx)("button",{onClick:a,disabled:!r.trim()||o,className:"px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:o?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"添加中..."]}):"添加"})]})]})}function o(e){let{menuList:r,onDeleteDish:t,onClearAll:a}=e,l=e=>{let r=["from-orange-50 to-red-50 border-orange-200 hover:border-orange-300","from-yellow-50 to-orange-50 border-yellow-200 hover:border-yellow-300","from-red-50 to-pink-50 border-red-200 hover:border-red-300","from-pink-50 to-rose-50 border-pink-200 hover:border-pink-300","from-green-50 to-emerald-50 border-green-200 hover:border-green-300","from-blue-50 to-cyan-50 border-blue-200 hover:border-blue-300","from-purple-50 to-violet-50 border-purple-200 hover:border-purple-300","from-indigo-50 to-blue-50 border-indigo-200 hover:border-indigo-300"];return r[e%r.length]};return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold text-gray-700",children:["菜品列表 (",r.length,")"]}),r.length>0&&a&&(0,s.jsx)("button",{onClick:a,className:"text-sm text-red-500 hover:text-red-700 transition-colors",children:"\uD83D\uDDD1️ 清空所有"})]}),0===r.length?(0,s.jsx)("p",{className:"text-gray-500 text-center py-8",children:"快添加你的第一个菜吧~ \uD83E\uDD58"}):(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:r.map((e,r)=>(0,s.jsxs)("div",{className:"relative bg-gradient-to-br ".concat(l(r)," border-2 rounded-xl p-4 hover:shadow-xl transition-all duration-300 transform hover:scale-105 hover:-translate-y-1 group"),children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-3xl mb-2 filter drop-shadow-sm",children:"\uD83E\uDD58"}),(0,s.jsx)("div",{className:"text-sm font-semibold text-gray-700 leading-tight min-h-[2.5rem] flex items-center justify-center",title:e,children:(0,s.jsx)("span",{className:"line-clamp-2",children:e})})]}),(0,s.jsx)("button",{onClick:r=>{r.preventDefault(),r.stopPropagation(),t(e)},className:"absolute -top-2 -right-2 w-7 h-7 bg-red-500 text-white rounded-full text-sm font-bold hover:bg-red-600 transition-all duration-200 opacity-0 group-hover:opacity-100 flex items-center justify-center shadow-lg hover:shadow-xl transform hover:scale-110 z-10",title:"删除这道菜",children:"\xd7"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-orange-400/0 to-red-400/0 group-hover:from-orange-400/5 group-hover:to-red-400/5 rounded-xl transition-all duration-300"})]},r))})]})}function n(e){let{menuList:r,selectedDish:t,showResult:a,onRandomPick:l}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 border-2 border-red-200 rounded-xl shadow-xl p-8 mb-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("button",{onClick:l,className:"w-full max-w-md py-6 bg-gradient-to-r from-red-500 to-orange-500 text-white text-2xl font-bold rounded-xl hover:from-red-600 hover:to-orange-600 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl",children:"\uD83C\uDFB2 今天吃什么"}),(0,s.jsx)("p",{className:"text-gray-600 mt-4 text-sm",children:r.length>0?"从 ".concat(r.length," 道菜中为你随机选择"):"将从常见菜品中为你随机选择，也可以在下方添加自己的菜品"})]})}),a&&(0,s.jsxs)("div",{className:"bg-gradient-to-r from-yellow-400 via-orange-400 to-red-500 rounded-xl shadow-2xl p-8 mb-6 text-center relative overflow-hidden animate-in slide-in-from-top duration-500",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-yellow-300/20 to-red-300/20 animate-pulse"}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)("h3",{className:"text-3xl font-bold text-white mb-6 drop-shadow-lg animate-bounce",children:"\uD83C\uDF89 今天就吃："}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl py-8 px-10 inline-block transform hover:scale-105 transition-all duration-300 shadow-2xl border-4 border-white/50 backdrop-blur-sm",children:[(0,s.jsx)("div",{className:"text-6xl font-bold text-gray-800 mb-4 animate-pulse",children:"\uD83C\uDF74"}),(0,s.jsx)("div",{className:"text-3xl md:text-4xl font-bold text-gray-800 leading-tight",children:t})]})]}),(0,s.jsx)("div",{className:"mt-8 flex justify-center relative z-10",children:(0,s.jsx)("button",{onClick:()=>{if(navigator.share)navigator.share({title:"今天吃什么",text:"今天决定吃：".concat(t,"！")});else{var e;null==(e=navigator.clipboard)||e.writeText("今天决定吃：".concat(t,"！"))}},className:"px-6 py-3 bg-white/20 text-white rounded-xl hover:bg-white/30 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 backdrop-blur-sm border border-white/30",children:"\uD83D\uDCF1 分享结果"})})]})]})}function d(){let[e,r]=(0,a.useState)([]),[t,d]=(0,a.useState)(""),[i,c]=(0,a.useState)(""),[h,x]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),[b,g]=(0,a.useState)(null);(0,a.useEffect)(()=>{p()},[]);let p=async()=>{try{u(!0),g(null);let e=await fetch("/api/dishes"),t=await e.json();t.success?r(t.data):g(t.error||"加载菜品失败")}catch(e){console.error("Error loading dishes:",e),g("网络错误，请检查连接")}finally{u(!1)}},f=async()=>{let e=t.trim();if(e)try{u(!0),g(null);let t=await fetch("/api/dishes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}),s=await t.json();s.success?(r(s.data),d("")):g(s.error||"添加菜品失败")}catch(e){console.error("Error adding dish:",e),g("网络错误，请检查连接")}finally{u(!1)}},j=async e=>{try{u(!0),g(null);let t=await fetch("/api/dishes",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}),s=await t.json();s.success?r(s.data):g(s.error||"删除菜品失败")}catch(e){console.error("Error deleting dish:",e),g("网络错误，请检查连接")}finally{u(!1)}},v=async()=>{let t=e;if(0===t.length)try{u(!0);let e=await fetch("/api/dishes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dishes:y})}),s=await e.json();s.success?(t=s.data,r(t)):t=y}catch(e){console.error("Error adding preset dishes:",e),t=y}finally{u(!1)}if(t.length>0){let e=Math.floor(Math.random()*t.length);c(t[e]),x(!0)}},y=["红烧肉","糖醋排骨","宫保鸡丁","鱼香肉丝","麻婆豆腐","回锅肉","青椒肉丝","蒜泥白肉","水煮鱼","口水鸡","酸辣土豆丝","蒜蓉菠菜","清炒小白菜","番茄炒蛋","韭菜炒蛋","红烧鲫鱼","清蒸鲈鱼","白灼虾","油爆虾","糟凤爪","腌笃鲜","三鲜汤","萝卜煨肉汤","荠菜豆腐羹","蘑菇汤"],N=async()=>{try{u(!0),g(null);let e=await fetch("/api/dishes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dishes:y})}),t=await e.json();t.success?r(t.data):g(t.error||"添加预设菜品失败")}catch(e){console.error("Error adding preset dishes:",e),g("网络错误，请检查连接")}finally{u(!1)}},w=async()=>{if(window.confirm("确定要清空所有菜品吗？"))try{u(!0),g(null);let e=await fetch("/api/dishes",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({clearAll:!0})}),t=await e.json();t.success?(r(t.data),x(!1)):g(t.error||"清空菜品失败")}catch(e){console.error("Error clearing dishes:",e),g("网络错误，请检查连接")}finally{u(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50 py-8 px-4",children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-4xl md:text-5xl font-bold text-center text-gray-800 mb-8",children:"\uD83C\uDF7D️ 今天吃什么？"}),(0,s.jsx)(n,{menuList:e,selectedDish:i,showResult:h,onRandomPick:v}),(0,s.jsxs)("div",{className:"my-8",children:[(0,s.jsx)("div",{className:"border-t border-gray-200 mb-6"}),(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-700 mb-2",children:"\uD83D\uDCDD 菜品管理"}),(0,s.jsx)("p",{className:"text-gray-500",children:"添加和管理你的菜品列表"})]})]}),b&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"text-red-500 mr-2",children:"⚠️"}),(0,s.jsx)("p",{className:"text-red-700",children:b}),(0,s.jsx)("button",{onClick:()=>g(null),className:"ml-auto text-red-500 hover:text-red-700",children:"✕"})]})}),(0,s.jsx)(l,{inputValue:t,setInputValue:d,onAddDish:f,onKeyPress:e=>{"Enter"===e.key&&f()},loading:m}),0===e.length&&!m&&(0,s.jsxs)("div",{className:"bg-blue-50 rounded-lg shadow-lg p-6 mb-6 border border-blue-200",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-blue-700 mb-4",children:"快速开始"}),(0,s.jsx)("p",{className:"text-blue-600 mb-4",children:"还没有菜品？试试添加一些常见的菜品吧！"}),(0,s.jsx)("button",{onClick:N,disabled:m,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"\uD83C\uDF7D️ 添加常见菜品"})]}),m&&(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg shadow-lg p-6 mb-6 text-center",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-orange-500 mr-3"}),(0,s.jsx)("p",{className:"text-gray-600",children:"正在处理中..."})]})}),(0,s.jsx)(o,{menuList:e,onDeleteDish:j,onClearAll:w}),e.length>0&&(0,s.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-center",children:(0,s.jsxs)("p",{className:"text-gray-600",children:["\uD83D\uDCCA 当前有 ",(0,s.jsx)("span",{className:"font-bold text-orange-500",children:e.length})," 道菜品",e.length>=10&&(0,s.jsx)("span",{className:"ml-2",children:"\uD83C\uDF89 选择丰富！"})]})}),(0,s.jsxs)("footer",{className:"text-center text-gray-500 mt-8",children:[(0,s.jsx)("p",{children:"\uD83C\uDF7D️ 让选择变得简单，让用餐变得有趣！"}),(0,s.jsx)("p",{className:"text-sm mt-2",children:"\uD83D\uDCA1 小贴士：添加更多菜品，让选择更有趣"})]})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[441,684,358],()=>r(167)),_N_E=e.O()}]);